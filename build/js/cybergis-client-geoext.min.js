/*! cybergis-client 22-07-2015 */
GeoExt.AdvancedPopup=Ext.extend(GeoExt.Popup,{anchored:!0,unpinnable:!1,resizable:!1,maximizable:!1,collapsible:!1,closeAction:"close",anchorPosition:"bottom-left",anchorPositionToBaseClass:{top:{classes:"hiu-popup-anc-top"},"top-left":{classes:"hiu-popup-anc-top-left"},"top-right":{classes:"hiu-popup-anc-top-right"},left:{classes:"hiu-popup-anc-left"},right:{classes:"hiu-popup-anc-right"},bottom:{classes:"hiu-popup-anc-bottom"},"bottom-left":{classes:"hiu-popup-anc-bottom-left"},"bottom-right":{classes:"hiu-popup-anc-bottom-right"}},getAnchorPosition:function(){return this.anchorPosition},getAnchorClass:function(){if(void 0!=this.anchorPositionToBaseClass[""+this.getAnchorPosition()]){var a=this.anchorPositionToBaseClass[""+this.getAnchorPosition()].classes;return $.browser.msie?a+"-ie-"+this.width+"-"+this.height:a+"-"+this.width+"-"+this.height}return""},isAnchorOnTop:function(){return"top"==this.getAnchorPosition()||"top-left"==this.getAnchorPosition()||"top-right"==this.getAnchorPosition()},isAnchorOnLeft:function(){return"left"==this.getAnchorPosition()},isAnchorOnRight:function(){return"right"==this.getAnchorPosition()},isAnchorOnBottom:function(){return"bottom"==this.getAnchorPosition()||"bottom-left"==this.getAnchorPosition()||"bottom-right"==this.getAnchorPosition()},onRender:function(a,b){GeoExt.Popup.superclass.onRender.call(this,a,b),this.ancCls=this.getAnchorClass(),this.createElement("anc",this.el.dom)},position:function(){if(this._mapMove===!0){var a=this.map.getExtent().containsLonLat(this.location);a!==this.isVisible()&&this.setVisible(a)}if(this.isVisible()){var b=this.map.getViewPortPxFromLonLat(this.location),c=Ext.fly(this.map.div).getBox(),d=this.anc,e=d.getLeft(!0)+d.getWidth()/2,f=this.el.getHeight();this.isAnchorOnTop()?f=-1*d.getHeight()-6:this.isAnchorOnBottom()?f+=4:this.isAnchorOnLeft()?(e=d.getLeft(!0),f=this.el.getHeight()/2+4):this.isAnchorOnRight()&&(e=d.getLeft(!0)+d.getWidth()-2,f=this.el.getHeight()/2),this.setPosition(b.x+c.x-e,b.y+c.y-f)}},setPosition:function(a,b){if(a&&"number"==typeof a[1]&&(b=a[1],a=a[0]),this.x=a,this.y=b,!this.boxReady)return this;var c=this.adjustPosition(a,b),d=c.x,e=c.y,f=this.getPositionEl();return(void 0!==d||void 0!==e)&&(void 0!==d&&void 0!==e?f.setLeftTop(d,e):void 0!==d?f.setLeft(d):void 0!==e&&f.setTop(e),this.onPosition(d,e),this.fireEvent("move",this,d,e)),this},initComponent:function(){GeoExt.AdvancedPopup.superclass.initComponent.call(this)}});